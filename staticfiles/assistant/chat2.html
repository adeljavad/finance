<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>سایدبار حرفه‌ای - سیستم مالی هوشمند</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6c5ce7;
      --primary-light: #a29bfe;
      --secondary: #00cec9;
      --success: #00b894;
      --danger: #d63031;
      --warning: #fdcb6e;
      --info: #00cec9;
      --light: #f8f9fa;
      --dark: #2d3436;
      --sidebar-width: 320px;
      --sidebar-collapsed-width: 70px;
      --transition-speed: 0.3s;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Vazirmatn', sans-serif;
      background-color: #f7f9fc;
      color: #333;
      overflow-x: hidden;
    }
    
    /* حالت کامل سایدبار */
    .sidebar {
      position: fixed;
      top: 0;
      right: 0;
      height: 100vh;
      width: var(--sidebar-width);
      background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
      color: white;
      z-index: 1050;
      transition: all var(--transition-speed) ease;
      box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    /* حالت collapsed سایدبار */
    .sidebar.collapsed {
      width: var(--sidebar-collapsed-width);
    }
    
    .sidebar-header {
      padding: 1.25rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      position: sticky;
      top: 0;
      background: rgba(108, 92, 231, 0.9);
      z-index: 100;
    }
    
    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      font-size: 1.1rem;
    }
    
    .sidebar-logo i {
      font-size: 1.5rem;
    }
    
    .sidebar-actions {
      display: flex;
      gap: 8px;
    }
    
    .sidebar-actions .btn {
      width: 36px;
      height: 36px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
    }
    
    .sidebar-body {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      padding-bottom: 2rem;
    }
    
    /* پانل‌های سایدبار */
    .sidebar-panel {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 14px;
      margin-bottom: 1.25rem;
      overflow: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .sidebar-panel:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }
    
    .panel-header {
      padding: 1rem 1.25rem;
      background: rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .panel-header:hover {
      background: rgba(0, 0, 0, 0.15);
    }
    
    .panel-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      font-size: 1.05rem;
    }
    
    .panel-title i {
      font-size: 1.1rem;
    }
    
    .panel-content {
      padding: 0 1.25rem;
      max-height: 1000px;
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), padding 0.4s ease;
    }
    
    .sidebar.collapsed .panel-content {
      max-height: 0;
      padding: 0;
    }
    
    .panel-content-inner {
      padding: 0.75rem 0 1.25rem;
    }
    
    /* گرید ابزارها */
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 0.75rem;
    }
    
    .tool-item {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 12px 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: white;
      font-size: 0.95rem;
      font-weight: 500;
    }
    
    .tool-item:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
    }
    
    .tool-item i {
      display: block;
      font-size: 1.4rem;
      margin-bottom: 6px;
      color: white;
    }
    
    .tool-item span {
      display: block;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* حالت collapsed - نمایش آیکون‌ها */
    .sidebar.collapsed .sidebar-logo span,
    .sidebar.collapsed .sidebar-actions .btn:not(:last-child),
    .sidebar.collapsed .panel-title span,
    .sidebar.collapsed .panel-content,
    .sidebar.collapsed .tool-item span {
      display: none;
    }
    
    .sidebar.collapsed .sidebar-logo i {
      margin: 0;
    }
    
    .sidebar.collapsed .tools-grid {
      grid-template-columns: 1fr;
    }
    
    .sidebar.collapsed .tool-item {
      padding: 15px 0;
    }
    
    /* tooltip برای حالت collapsed */
    .sidebar.collapsed .panel-header::after,
    .sidebar.collapsed .tool-item::after {
      content: attr(data-tooltip);
      position: fixed;
      left: calc(var(--sidebar-collapsed-width) + 15px);
      background: rgba(0, 0, 0, 0.85);
      color: white;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-family: 'Vazirmatn', sans-serif;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 1000;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    .sidebar.collapsed .panel-header:hover::after,
    .sidebar.collapsed .tool-item:hover::after {
      opacity: 1;
    }
    
    /* پانل وضعیت */
    .status-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(0, 0, 0, 0.2);
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.9rem;
      margin-top: 8px;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      background: #00b894;
      border-radius: 50%;
      display: inline-block;
    }
    
    /* دکمه‌های عملیات سریع */
    .action-buttons {
      display: flex;
      gap: 8px;
      margin-top: 15px;
    }
    
    .action-btn {
      flex: 1;
      border-radius: 12px;
      padding: 8px 0;
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: all 0.25s ease;
    }
    
    /* حالت موبایل */
    @media (max-width: 991.98px) {
      .sidebar {
        transform: translateX(var(--sidebar-width));
      }
      
      .sidebar.active {
        transform: translateX(0);
      }
      
      .sidebar.collapsed {
        transform: translateX(var(--sidebar-collapsed-width));
      }
      
      .sidebar.collapsed.active {
        transform: translateX(0);
      }
      
      .sidebar-overlay {
        position: fixed;
        top: 0;
        right: 0;
        left: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1040;
        display: none;
      }
      
      .sidebar-overlay.active {
        display: block;
      }
    }
    
    /* دکمه باز/بسته کردن سایدبار */
    .toggle-sidebar-btn {
      position: fixed;
      bottom: 30px;
      left: 30px;
      z-index: 1000;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      box-shadow: 0 4px 20px rgba(108, 92, 231, 0.4);
      transition: all 0.3s ease;
      border: none;
    }
    
    .toggle-sidebar-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 25px rgba(108, 92, 231, 0.6);
    }
    
    /* انیمیشن‌ها */
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(108, 92, 231, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(108, 92, 231, 0); }
      100% { box-shadow: 0 0 0 0 rgba(108, 92, 231, 0); }
    }
    
    .pulse-animation {
      animation: pulse 2s infinite;
    }
    
    /* کارت ویژگی‌ها */
    .feature-card {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 12px;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .feature-card:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: translateX(-5px);
    }
    
    .feature-icon {
      font-size: 1.4rem;
      margin-bottom: 8px;
      display: block;
    }
    
    /* آپلود فایل */
    .upload-area {
      border: 2px dashed rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      padding: 25px 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 15px 0;
    }
    
    .upload-area:hover {
      border-color: white;
      background: rgba(255, 255, 255, 0.05);
    }
    
    .upload-icon {
      font-size: 2.5rem;
      margin-bottom: 10px;
      color: white;
    }
  </style>
</head>
<body>
  <!-- overlay برای حالت موبایل -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>
  
  <!-- سایدبار اصلی -->
  <div class="sidebar" id="mainSidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <i class="fas fa-robot"></i>
        <span class="logo-text">دستیار مالی هوشمند</span>
      </div>
      <div class="sidebar-actions">
        <button class="btn btn-sm btn-light d-none d-md-inline-flex" id="toggleCollapseBtn" title="کوچک/بزرگ کردن سایدبار">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="btn btn-sm btn-light d-md-none" id="closeSidebarBtn" title="بستن سایدبار">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
    
    <div class="sidebar-body">
      <!-- پانل وضعیت سیستم -->
      <div class="sidebar-panel">
        <div class="panel-header" data-panel="status">
          <div class="panel-title">
            <i class="fas fa-server"></i>
            <span>وضعیت سیستم</span>
          </div>
          <i class="fas fa-chevron-down panel-toggle-icon"></i>
        </div>
        <div class="panel-content">
          <div class="panel-content-inner">
            <div class="status-indicator">
              <span class="status-dot"></span>
              آنلاین - 0 سند فعال
            </div>
            <div class="action-buttons">
              <button class="action-btn bg-light text-dark" onclick="clearChat()">
                <i class="fas fa-broom"></i>
                <span>پاک کردن</span>
              </button>
              <button class="action-btn bg-info text-white" onclick="toggleTheme()">
                <i class="fas fa-palette"></i>
                <span>تم</span>
              </button>
            </div>
            <div class="mt-3 p-2 bg-white bg-opacity-10 rounded text-center">
              <span class="text-white">0 ترجیح ذخیره شده</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- پانل ابزارها -->
      <div class="sidebar-panel">
        <div class="panel-header" data-panel="tools">
          <div class="panel-title">
            <i class="fas fa-tools"></i>
            <span>ابزارهای تحلیل</span>
          </div>
          <i class="fas fa-chevron-down panel-toggle-icon"></i>
        </div>
        <div class="panel-content">
          <div class="panel-content-inner">
            <div class="tools-grid">
              <div class="tool-item" data-tooltip="تحلیل ترازنامه" onclick="analyzeBalanceSheet()">
                <i class="fas fa-balance-scale"></i>
                <span>ترازنامه</span>
              </div>
              <div class="tool-item" data-tooltip="گزارش مالی" onclick="generateFinancialReport()">
                <i class="fas fa-file-invoice-dollar"></i>
                <span>گزارش مالی</span>
              </div>
              <div class="tool-item" data-tooltip="نسبت‌های مالی" onclick="calculateFinancialRatios()">
                <i class="fas fa-calculator"></i>
                <span>نسبت‌های مالی</span>
              </div>
              <div class="tool-item" data-tooltip="جریان نقدی" onclick="analyzeCashFlow()">
                <i class="fas fa-money-bill-wave"></i>
                <span>جریان نقدی</span>
              </div>
              <div class="tool-item" data-tooltip="تحلیل سودآوری" onclick="quickAction('تحلیل سودآوری و بازدهی سرمایه گذاری')">
                <i class="fas fa-chart-line"></i>
                <span>سودآوری</span>
              </div>
              <div class="tool-item" data-tooltip="صفحه کامل" onclick="window.location.href='/pages/tools-page/'">
                <i class="fas fa-external-link-alt"></i>
                <span>صفحه کامل</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- پانل داده و نمونه‌ها -->
      <div class="sidebar-panel">
        <div class="panel-header" data-panel="data">
          <div class="panel-title">
            <i class="fas fa-database"></i>
            <span>داده‌ها و نمونه‌ها</span>
          </div>
          <i class="fas fa-chevron-down panel-toggle-icon"></i>
        </div>
        <div class="panel-content">
          <div class="panel-content-inner">
            <div class="tools-grid">
              <div class="tool-item" data-tooltip="نمایش داده نمونه" onclick="showSampleData()">
                <i class="fas fa-table"></i>
                <span>داده نمونه</span>
              </div>
              <div class="tool-item" data-tooltip="دانلود تمپلیت" onclick="downloadTemplate()">
                <i class="fas fa-download"></i>
                <span>دانلود تمپلیت</span>
              </div>
              <div class="tool-item" data-tooltip="آپلود فایل" onclick="document.getElementById('fileUpload').click()">
                <i class="fas fa-file-upload"></i>
                <span>آپلود فایل</span>
              </div>
              <div class="tool-item" data-tooltip="راهنما" onclick="showTemplateInfo()">
                <i class="fas fa-info-circle"></i>
                <span>راهنما</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- پانل خوشامدگویی -->
      <div class="sidebar-panel">
        <div class="panel-header" data-panel="welcome">
          <div class="panel-title">
            <i class="fas fa-gem"></i>
            <span>دستیار مالی</span>
          </div>
          <i class="fas fa-chevron-down panel-toggle-icon"></i>
        </div>
        <div class="panel-content">
          <div class="panel-content-inner">
            <div class="feature-card">
              <i class="fas fa-chart-line feature-icon text-primary"></i>
              <strong>تحلیل ترازنامه و صورت‌های مالی</strong>
            </div>
            <div class="feature-card">
              <i class="fas fa-file-invoice-dollar feature-icon text-success"></i>
              <strong>تهیه گزارش‌های مالی دوره‌ای</strong>
            </div>
            <div class="feature-card">
              <i class="fas fa-calculator feature-icon text-purple"></i>
              <strong>محاسبه نسبت‌های مالی و نقدینگی</strong>
            </div>
            <div class="mt-3 p-3 bg-white bg-opacity-10 rounded">
              <p class="text-white mb-0">
                <i class="fas fa-lightbulb text-warning me-1"></i>
                <small>می‌توانید اسناد مالی خود را آپلود کنید تا بر اساس آن‌ها تحلیل دقیق‌تری ارائه دهم.</small>
              </p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- پانل آپلود فایل -->
      <div class="sidebar-panel">
        <div class="panel-header" data-panel="upload">
          <div class="panel-title">
            <i class="fas fa-cloud-upload-alt"></i>
            <span>آپلود اسناد</span>
          </div>
          <i class="fas fa-chevron-down panel-toggle-icon"></i>
        </div>
        <div class="panel-content">
          <div class="panel-content-inner">
            <div class="upload-area" onclick="document.getElementById('fileUpload').click()">
              <i class="fas fa-cloud-upload-alt upload-icon"></i>
              <p class="text-white mb-0">فایل‌های Excel یا CSV را اینجا بکشید یا کلیک کنید</p>
            </div>
            <input type="file" id="fileUpload" accept=".xlsx,.xls,.csv" class="d-none">
            
            <div class="d-grid gap-2 mt-3">
              <button class="btn btn-success" onclick="showTemplateInfo()">
                <i class="fas fa-info-circle me-1"></i> راهنما
              </button>
              <button class="btn btn-primary" onclick="downloadTemplate()">
                <i class="fas fa-download me-1"></i> دانلود تمپلیت
              </button>
              <button class="btn btn-info" onclick="window.location.href='/pages/upload-page/'">
                <i class="fas fa-external-link-alt me-1"></i> صفحه کامل
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- دکمه باز کردن سایدبار در موبایل -->
  <button class="toggle-sidebar-btn" id="openSidebarBtn">
    <i class="fas fa-sliders-h"></i>
  </button>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // متغیرهای وضعیت
      let isSidebarCollapsed = false;
      const sidebar = document.getElementById('mainSidebar');
      const toggleCollapseBtn = document.getElementById('toggleCollapseBtn');
      const closeSidebarBtn = document.getElementById('closeSidebarBtn');
      const openSidebarBtn = document.getElementById('openSidebarBtn');
      const sidebarOverlay = document.getElementById('sidebarOverlay');
      
      // بارگذاری وضعیت collapsed از localStorage
      const savedCollapsed = localStorage.getItem('sidebarCollapsed');
      if (savedCollapsed === 'true') {
        sidebar.classList.add('collapsed');
        isSidebarCollapsed = true;
        toggleCollapseBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
      }
      
      // تغییر وضعیت collapsed
      toggleCollapseBtn.addEventListener('click', function() {
        sidebar.classList.toggle('collapsed');
        isSidebarCollapsed = !isSidebarCollapsed;
        
        // تغییر آیکون
        if (isSidebarCollapsed) {
          toggleCollapseBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
          toggleCollapseBtn.title = 'بزرگ کردن سایدبار';
        } else {
          toggleCollapseBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
          toggleCollapseBtn.title = 'کوچک کردن سایدبار';
        }
        
        // ذخیره وضعیت
        localStorage.setItem('sidebarCollapsed', isSidebarCollapsed);
      });
      
      // کنترل سایدبار در موبایل
      openSidebarBtn.addEventListener('click', function() {
        sidebar.classList.add('active');
        sidebarOverlay.classList.add('active');
      });
      
      closeSidebarBtn.addEventListener('click', function() {
        sidebar.classList.remove('active');
        sidebarOverlay.classList.remove('active');
      });
      
      sidebarOverlay.addEventListener('click', function() {
        sidebar.classList.remove('active');
        sidebarOverlay.classList.remove('active');
      });
      
      // کنترل پانل‌ها
      document.querySelectorAll('.panel-header').forEach(header => {
        header.addEventListener('click', function() {
          const panelContent = this.nextElementSibling;
          const toggleIcon = this.querySelector('.panel-toggle-icon');
          const panelId = this.getAttribute('data-panel');
          
          // بستن همه پانل‌ها به جز این یکی
          document.querySelectorAll('.panel-content').forEach(content => {
            if (content !== panelContent) {
              content.style.maxHeight = '0';
              content.previousElementSibling.querySelector('.panel-toggle-icon').className = 'fas fa-chevron-down panel-toggle-icon';
            }
          });
          
          // تغییر وضعیت این پانل
          const isExpanded = panelContent.style.maxHeight && panelContent.style.maxHeight !== '0';
          
          if (isExpanded) {
            panelContent.style.maxHeight = '0';
            toggleIcon.className = 'fas fa-chevron-down panel-toggle-icon';
          } else {
            panelContent.style.maxHeight = panelContent.scrollHeight + 'px';
            toggleIcon.className = 'fas fa-chevron-up panel-toggle-icon';
          }
        });
      });
      
      // توابع نمونه (باید با توابع واقعی شما جایگزین شوند)
      window.clearChat = function() {
        alert('چت پاک شد');
      };
      
      window.toggleTheme = function() {
        alert('تم تغییر کرد');
      };
      
      window.analyzeBalanceSheet = function() {
        alert('تحلیل ترازنامه شروع شد');
      };
      
      window.generateFinancialReport = function() {
        alert('گزارش مالی تولید شد');
      };
      
      window.calculateFinancialRatios = function() {
        alert('محاسبه نسبت‌های مالی');
      };
      
      window.analyzeCashFlow = function() {
        alert('تحلیل جریان نقدی');
      };
      
      window.quickAction = function(action) {
        alert('عملیات: ' + action);
      };
      
      window.showSampleData = function() {
        alert('نمایش داده‌های نمونه');
      };
      
      window.downloadTemplate = function() {
        alert('دانلود تمپلیت');
      };
      
      window.showTemplateInfo = function() {
        alert('نمایش راهنما');
      };
      
      // مانیتورینگ تغییر اندازه صفحه
      window.addEventListener('resize', function() {
        if (window.innerWidth > 991 && sidebar.classList.contains('active')) {
          sidebar.classList.remove('active');
          sidebarOverlay.classList.remove('active');
        }
      });
      
      // کاربرد فایل آپلود
      document.getElementById('fileUpload').addEventListener('change', function(e) {
        if (this.files.length > 0) {
          const fileName = this.files[0].name;
          alert(`فایل "${fileName}" بارگذاری شد`);
        }
      });
    });
  </script>
</body>
</html>

